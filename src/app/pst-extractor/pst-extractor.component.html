<div class="px-5">
    <div class="row">
        <div class="col-3 border-round" *ngIf="isShowFolderView">
            <div class="d-grid">
                <span><strong class="font-x-large">Folder View</strong></span>
            </div>
            <ul class="list-group pt-3" *ngIf="extractedData.length > 0">
                <li class="list-group-item hand-cursor" *ngFor="let data of extractedData"
                    (click)="onClickFolder(data)">
                    <span>{{data?.folder_name}}</span>
                </li>
            </ul>
        </div>
        <div class="" [ngClass]="extractedData.length > 0 ? 'col-9' : 'col-12'" *ngIf="!isShowContentData">
            <div class="card text-center my-5">
                <div class="card-header">
                    Email Extractor and Header Analysis
                </div>
                <div class="card-body">
                    <h5 class="card-title">Email PST File Extractor</h5>
                    <p class="card-text">This will extract input email pst file for forensic analysis using python
                        server</p>
                    <div class="row">
                        <div class="align-items-center col-12 d-flex justify-content-center ms-5 ps-5">
                            <input type="file" id="pstFile" name="pstFile" accept=".pst"
                                (change)="onSelectPstFile($event)" />
                        </div>
                    </div>
                    <a href="#" class="btn btn-primary my-4" (click)="getData()">Extract PST File</a>
                </div>
                <div class="card-footer text-muted">
                    Extracted result will be shown below
                </div>
            </div>
        </div>
        <div class="col-9 table-height" *ngIf="isShowContentData && contactsArray.length == 0">
            <div class="input-group mb-3">
                <span>
                    <label class="fw-semibold ml-2 pt-1">Search by keyword : </label>
                </span>
                <input type="search" class="form-control ms-3 ps-2" placeholder="Search with any keyword" aria-label="Search by" aria-describedby="basic-addon1"
                [(ngModel)]="searchWord" (ngModelChange)="onChangeSearch()">
            </div>
            <table class="table table-striped table-bordered" *ngIf="messageArray.length > 0;else noData">
                <thead class="table-header">
                    <tr>
                        <th scope="col">From</th>
                        <th scope="col">To</th>
                        <th scope="col">Cc</th>
                        <th scope="col">Sender Name</th>
                        <th scope="col">Subject</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let msg of messageArray; let index=index">
                        <td data-bs-toggle="modal" data-bs-target="#exampleModal" class="hand-cursor"
                            (click)=" onClickTable(msg, index)">
                            {{msg.sender_email}}</td>
                        <td data-bs-toggle="modal" data-bs-target="#exampleModal" class="hand-cursor"
                            (click)=" onClickTable(msg, index)">
                            {{msg.to}}</td>
                        <td data-bs-toggle="modal" data-bs-target="#exampleModal" class="hand-cursor"
                            (click)=" onClickTable(msg, index)">
                            {{msg.cc}}</td>
                        <td data-bs-toggle="modal" data-bs-target="#exampleModal" class="hand-cursor"
                            (click)=" onClickTable(msg, index)">
                            {{msg.sender_name}}</td>
                        <td data-bs-toggle="modal" data-bs-target="#exampleModal" class="hand-cursor"
                            (click)="onClickTable(msg, index)">
                            {{msg.subject}}</td>
                    </tr>
                </tbody>
            </table>
            <ng-template #noData>
                <div class="card">
                    <div class="card-body">
                      No Data
                    </div>
                  </div>
            </ng-template>
        </div>

        <div class="col-9 table-height" *ngIf="contactsArray.length > 0">
            <table class="table table-striped table-bordered">
                <thead class="table-header">
                    <tr>
                        <th scope="col">Contact Name</th>
                        <th scope="col">Contact Email</th>
                        <th scope="col">Contact Phone</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let contact of contactsArray">
                        <td class="hand-cursor">
                            {{contact.name}}</td>
                        <td class="hand-cursor">
                            {{contact.email}}</td>
                        <td class="hand-cursor">
                            {{contact.phone}}</td>
                    </tr>
                </tbody>
            </table>
        </div>


    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Detailed Header Analysis</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body header-analysis-body">
                <div class="card">
                    <div class="card-body">
                        <div class="row px-2">
                            <div class="card header-analysis-card">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-12">
                                            <label class="fw-bold">Message ID :</label>
                                            <span class="ps-2">{{parsedHeaders['Message-Id']}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Creation Time :</label>
                                            <span class="ps-2">{{convertToDateObject(headerData.creation_time)}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Signature :</label>
                                            <span class="ps-2">{{headerData.signature}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Delivery Time :</label>
                                            <span class="ps-2">{{convertToDateObject(modalData.delivery_time)}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">File Format :</label>
                                            <span class="ps-2">{{headerData.file_format}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Modification Time :</label>
                                            <span
                                                class="ps-2">{{convertToDateObject(headerData.modification_time)}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Version :</label>
                                            <span class="ps-2">{{headerData.version}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Sender Name:</label>
                                            <span class="ps-2">{{modalData.sender_name}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Sender Email:</label>
                                            <span class="ps-2">{{modalData.sender_email}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Sender Address Type :</label>
                                            <span class="ps-2">{{modalData.sender_address_type}}</span>
                                        </div>
                                        <!-- <div class="col-12">
                                            <label class="fw-bold">Sender IP Address:</label>
                                            <span class="ps-2">{{modalData.sender_ip_address}}</span>
                                        </div> -->
                                        <div class="col-12">
                                            <label class="fw-bold">Sender SMTP Address:</label>
                                            <span class="ps-2">{{modalData.sender_smtp_address}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Client Submit Time :</label>
                                            <span class="ps-2">{{modalData.client_submit_time}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Conversation Topic :</label>
                                            <span class="ps-2">{{modalData.conversation_topic}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Receiver IP Address:</label>
                                            <span class="ps-2">{{modalData.receiver_ip_address}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Receiver Name:</label>
                                            <span class="ps-2">{{modalData.to}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">ESMTP ID:</label>
                                            <span class="ps-2">{{receivedList[0]?.id}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Sender Domain:</label>
                                            <span class="ps-2">{{receivedList[0]?.senderDomain}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Sender IP:</label>
                                            <span class="ps-2">{{receivedList[0]?.senderIP}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Receiver Domain:</label>
                                            <span class="ps-2">{{receivedList[0]?.receiverDomain}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Receiver Server:</label>
                                            <span class="ps-2">{{receivedList[0]?.receivingServer}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Date:</label>
                                            <span class="ps-2">{{receivedList[0]?.date}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Date and Time:</label>
                                            <span class="ps-2">{{receivedList[0]?.dateAndTime}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Day:</label>
                                            <span class="ps-2">{{receivedList[0]?.timestamp}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Time and TimeZone:</label>
                                            <span class="ps-2">{{receivedList[0]?.timeAndTimeZone}}</span>
                                        </div>
                                        <div class="col-12">
                                            <label class="fw-bold">Images Used :</label>
                                            <span *ngFor="let image of imagesArray" class="ps-2">{{image}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <label class="fs-4 fw-bolder">Message Body :</label>
                            <span class="ps-2" [innerHTML]="modalData.body"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
